# <!-- Powered by BMAD™ Core -->
# Story 1.5: Formulário de Criação de Evento

## Status

**Draft**

## Story

**As a** organizador,
**I want** criar um novo evento de churrasco facilmente,
**So that** eu possa começar a organizar sem complicações.

## Acceptance Criteria

1. Formulário simples com campos: Nome do evento, Data, Local
2. Template pré-preenchido com itens básicos (carne, bebidas, carvão)
3. Estimativa automática de quantidades baseada no número de pessoas
4. Botão "Criar Evento" que salva e gera ID único

## Tasks / Subtasks

- [ ] Implementar componente EventForm no frontend (AC: 1)
  - [ ] Criar componente EventForm em `apps/web/src/components/event/EventForm/`
  - [ ] Implementar formulário com campos obrigatórios: name, date, location, estimatedParticipants
  - [ ] Adicionar validação de formulário conforme coding standards
  - [ ] Implementar CSS Modules para estilização responsiva
  - [ ] Configurar state management local com useState

- [ ] Implementar template de itens básicos (AC: 2, 3)
  - [ ] Criar constant BASIC_EVENT_TEMPLATE em `apps/web/src/utils/constants.js`
  - [ ] Implementar lógica de cálculo automático de quantidades baseada em estimatedParticipants
  - [ ] Definir template com: Picanha (0.4kg/pessoa), Cerveja (2 unidades/pessoa), Carvão (1kg/4 pessoas)
  - [ ] Adicionar categorização conforme EventItem model (carne, bebidas, carvao)

- [ ] Integrar API de criação de evento (AC: 4)
  - [ ] Implementar eventService.createEvent() em `apps/web/src/services/eventService.js`
  - [ ] Integrar com endpoint POST /events conforme API specification
  - [ ] Implementar tratamento de erro conforme error handling strategy
  - [ ] Configurar redirecionamento para página de evento após criação bem-sucedida
  - [ ] Garantir que organizerId e UUIDs sejam gerados automaticamente pelo backend

- [ ] Implementar rota e página de criação (AC: 1, 4)
  - [ ] Criar página CreateEvent em `apps/web/src/pages/CreateEvent/`
  - [ ] Configurar rota "/" (home) para apontar ao formulário de criação
  - [ ] Implementar integração entre página e componente EventForm
  - [ ] Adicionar loading state durante submissão do formulário

- [ ] Implementar testes unitários (Testing Strategy)
  - [ ] Criar teste do componente EventForm em `apps/web/tests/components/EventForm.test.js`
  - [ ] Testar validação de formulário e submissão
  - [ ] Criar teste do eventService em `apps/web/tests/services/eventService.test.js`
  - [ ] Testar cálculo automático de quantidades do template

## Dev Notes

### Previous Story Context

[Source: Story 1.4 completion notes]
- Ambiente Docker configurado e funcionando perfeitamente
- API executando em containers com hot-reload
- MongoDB containerizado com persistência de dados
- Testes unitários funcionando no ambiente containerizado
- Health check endpoint `/health` operacional
- Environment variables configuradas para desenvolvimento

### Data Models Context

[Source: architecture/data-models.md#event-model]
**Event Schema Requirements:**
- id: String (UUID) - gerado automaticamente pelo backend
- name: String (required, maxLength: 100, trim: true)
- date: Date (required)
- location: String (required, maxLength: 200, trim: true)  
- organizerId: String - gerado automaticamente pelo backend
- status: String - default 'draft'
- estimatedParticipants: Number (required, min: 1, max: 50)
- createdAt/updatedAt: Date - gerado automaticamente

[Source: architecture/data-models.md#eventitem-model]
**EventItem Template Fields:**
- name: String (required, maxLength: 100)
- category: String (enum: ['carne', 'bebidas', 'carvao', 'acompanhamentos', 'extras'])
- quantity: Number (required, min: 0)
- unit: String (enum: ['kg', 'unidade', 'litro', 'pacote'])
- estimatedCost: Number (required, min: 0, em centavos)
- isTemplate: Boolean (default: true para itens do template básico)

### API Integration Context

[Source: architecture/api-specification.md#rest-api-specification]
**POST /events Endpoint:**
- URL: `${API_BASE_URL}/events`
- Method: POST
- Required fields: name, date, location, estimatedParticipants
- Response: 201 Created com evento completo incluindo id e organizerId gerados
- Error handling: 400 Bad Request para validação, 500 para erros de servidor

[Source: architecture/frontend-architecture.md#frontend-services-layer]
**API Client Pattern:**
- Usar api.js base client com error handling
- Implementar eventService.createEvent() seguindo padrão estabelecido
- Content-Type: 'application/json'
- Tratamento de erros com try/catch e throw new Error

### Component Architecture Context

[Source: architecture/frontend-architecture.md#component-architecture]
**Component Organization Pattern:**
```
apps/web/src/components/event/EventForm/
├── EventForm.jsx          // Componente principal
├── EventForm.module.css   // Estilos CSS Modules  
└── index.js              // Export barrel
```

**Component Template Pattern:**
- useState para state local do formulário
- useEffect para side effects se necessário
- handleSubmit para processamento do formulário
- Usar CSS Modules com naming convention kebab-case
- Props validation com PropTypes ou JSDoc

[Source: architecture/frontend-architecture.md#routing-architecture]
**Routing Pattern:**
- Rota "/" deve renderizar página de criação de evento
- Após criação bem-sucedida, redirecionar para `/event/${eventId}`
- Usar React Router para navegação programática

### Template de Itens Básicos

**Default Event Items Template:**
```javascript
const BASIC_EVENT_TEMPLATE = [
  {
    name: 'Picanha',
    category: 'carne',
    unit: 'kg',
    quantityPerPerson: 0.4,
    estimatedCostPerKg: 8000 // R$ 80.00 em centavos
  },
  {
    name: 'Cerveja',
    category: 'bebidas', 
    unit: 'unidade',
    quantityPerPerson: 2,
    estimatedCostPerUnit: 500 // R$ 5.00 em centavos
  },
  {
    name: 'Carvão',
    category: 'carvao',
    unit: 'kg', 
    quantityPerPerson: 0.25,
    estimatedCostPerKg: 1500 // R$ 15.00 em centavos
  }
];
```

### File Locations for Implementation

[Source: architecture/unified-project-structure.md]
**Frontend Files:**
- `apps/web/src/components/event/EventForm/EventForm.jsx` - componente principal
- `apps/web/src/components/event/EventForm/EventForm.module.css` - estilos
- `apps/web/src/pages/CreateEvent/CreateEvent.jsx` - página de criação  
- `apps/web/src/services/eventService.js` - service layer para API
- `apps/web/src/utils/constants.js` - template de itens básicos
- `apps/web/tests/components/EventForm.test.js` - testes do componente
- `apps/web/tests/services/eventService.test.js` - testes do service

### Project Structure Alignment

[Source: architecture/unified-project-structure.md]
- Seguir estrutura monorepo com workspaces
- Components organizados por domínio (event/, guest/, cost/)
- Services layer para comunicação com API
- CSS Modules para isolamento de estilos
- Tests organizados espelhando estrutura src/

### Testing

[Source: architecture/testing-strategy.md#frontend-tests]
**Required Test Coverage:**
- Component rendering com props obrigatórias
- Form validation e error states
- Template quantity calculations
- API integration mock tests
- User interaction flows (form submission)

**Test File Locations:**
- `apps/web/tests/components/EventForm.test.js`
- `apps/web/tests/services/eventService.test.js`

**Testing Patterns:**
- Use React Testing Library para componente tests
- Mock API calls com jest.mock()
- Test both happy path e error scenarios
- Verify form validation e user feedback

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-25 | 1.0 | Story criada para formulário de criação de evento | Bob (Scrum Master) |